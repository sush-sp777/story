this is chapter 2 and updated inside mars branch